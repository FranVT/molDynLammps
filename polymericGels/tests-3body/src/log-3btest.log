LAMMPS (22 Jul 2025)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
package omp 0
using multi-threaded neighbor list subroutines
# Input script to debug the threebody/table command
# Initialization
units lj
dimension 3
boundary p p p

# Styles of atoms and that stuff
atom_style atomic
pair_style hybrid/overlay zero 0.0 table/omp linear 5000000 threebody/table

newton on

# Create simulaiton box
region simulation_box block -$L $L -$L $L -$L $L
region simulation_box block -1 $L -$L $L -$L $L
region simulation_box block -1 1 -$L $L -$L $L
region simulation_box block -1 1 -1 $L -$L $L
region simulation_box block -1 1 -1 1 -$L $L
region simulation_box block -1 1 -1 1 -1 $L
region simulation_box block -1 1 -1 1 -1 1
# N-atom-types region-ID keyword value Is necesesary the extra/special/per/atom (# of special neighbors per atom)
create_box 2 simulation_box
Created orthogonal box = (-1 -1 -1) to (1 1 1)
  2 by 2 by 2 MPI processor grid

# Atom types
mass 1 1.0      # PA
mass 2 1.0      # PB

# Coefficients
include potential.in
# Script with the pair-wise interaction and bonds between particles

pair_coeff 1 1 zero 0.5
pair_coeff 1 2 table/omp sysFiles/pachTab.table POT 0.6 # sw/omp sysFiles/patchyPot.sw NULL NULL PA PB
Reading pair table potential file sysFiles/pachTab.table with DATE: 2024-07-08
WARNING: 7 of 1000000 force values in table POT are inconsistent with -dE/dr.
WARNING:  Should only be flagged at inflection points (src/pair_table.cpp:469)
pair_coeff 2 2 table/omp sysFiles/pachTab.table POT 0.6 # sw/omp sysFiles/patchyPot.sw NULL NULL PA PB
Reading pair table potential file sysFiles/pachTab.table with DATE: 2024-07-08
WARNING: 7 of 1000000 force values in table POT are inconsistent with -dE/dr.
WARNING:  Should only be flagged at inflection points (src/pair_table.cpp:469)
pair_coeff * * threebody/table swapMech.3b PA PB


# Particles
include particles.in
# Script with all molecule information and create groups for computes

# Introduce the molecules
# ID style args keyword arg
region spawn_box block -$L $L -$L $L -$L $L
region spawn_box block -1 $L -$L $L -$L $L
region spawn_box block -1 1 -$L $L -$L $L
region spawn_box block -1 1 -1 $L -$L $L
region spawn_box block -1 1 -1 1 -$L $L
region spawn_box block -1 1 -1 1 -1 $L
region spawn_box block -1 1 -1 1 -1 1

# create_atoms type style args keyword values
# style_random: N seed region-ID
# keyword_mol: template-ID seed
# keyword_overlap: overlap value = only insert if at least this distance from all existing atoms
# keyword_maxtry: maxtry value = number of attempts to insert a particle before failure
create_atoms 1 random ${NPA} ${seed1} spawn_box overlap 0.5 maxtry 5000
create_atoms 1 random 3 ${seed1} spawn_box overlap 0.5 maxtry 5000
create_atoms 1 random 3 3234 spawn_box overlap 0.5 maxtry 5000
Created 3 atoms
  using lattice units in orthogonal box = (-1 -1 -1) to (1 1 1)
  create_atoms CPU = 0.000 seconds
create_atoms 2 random ${NPB} ${seed2} spawn_box overlap 0.5 maxtry 5000
create_atoms 2 random 3 ${seed2} spawn_box overlap 0.5 maxtry 5000
create_atoms 2 random 3 6321 spawn_box overlap 0.5 maxtry 5000
Created 3 atoms
  using lattice units in orthogonal box = (-1 -1 -1) to (1 1 1)
  create_atoms CPU = 0.000 seconds

# Create groups for the threebody potential
group PA type 1
3 atoms in group PA
group PB type 2
3 atoms in group PB

# Neighbor list
neighbor 1.8 bin # extra-distance style
#neigh_modify delay 0 every 1 check no
#neigh_modify exclude molecule/intra CrossLinker
#neigh_modify exclude molecule/intra Monomer

# COMPUTES

# Compute global kinetic and potential energy and temperature
compute t all temp
compute p all pressure t
compute ep all pe
compute ek all ke
variable eT equal etotal
variable eB equal ebond
variable eA equal eangle
variable eM equal emol
variable ec equal ecouple
variable eC equal econserve

# Potencial energy per pair-wise interaction
compute patchPair all pair table/omp epair
compute swapPair all pair threebody/table epair

# Compute the pressure
compute press all pressure t ke virial
compute pressVirial all pressure t virial
compute pressVirialMod all pressure t pair bond angle

# Computes for the stress
compute cstress all stress/atom t ke pair bond angle
compute cstressVirial all stress/atom t virial
compute cstressVirialMod all stress/atom t pair bond angle
compute stress all reduce sum c_cstress[*]
compute stressVirial all reduce sum c_cstressVirial[*]
compute stressVirialMod all reduce sum c_cstressVirialMod[*]

# DUMPS and FIXES

thermo ${NsaveStress}
thermo 1000

# Save global energies and temperature
fix Energy all ave/time 1 ${Nsave} ${Nsave} c_t c_patchPair c_swapPair c_ep c_ek v_eT v_ec v_eC c_p v_eB v_eA v_eM file ${Dir}/${file1_name}
fix Energy all ave/time 1 1000 ${Nsave} c_t c_patchPair c_swapPair c_ep c_ek v_eT v_ec v_eC c_p v_eB v_eA v_eM file ${Dir}/${file1_name}
fix Energy all ave/time 1 1000 1000 c_t c_patchPair c_swapPair c_ep c_ek v_eT v_ec v_eC c_p v_eB v_eA v_eM file ${Dir}/${file1_name}
fix Energy all ave/time 1 1000 1000 c_t c_patchPair c_swapPair c_ep c_ek v_eT v_ec v_eC c_p v_eB v_eA v_eM file /home/franvt/GitRepos/molDynLammps/polymericGels/tests-3body/data/0.05331-2026-01-27-165515/${file1_name}
fix Energy all ave/time 1 1000 1000 c_t c_patchPair c_swapPair c_ep c_ek v_eT v_ec v_eC c_p v_eB v_eA v_eM file /home/franvt/GitRepos/molDynLammps/polymericGels/tests-3body/data/0.05331-2026-01-27-165515/system_assembly.fixf

# Save Pressure and Stress tensor
fix fixStress5 all ave/time 1 ${NsaveStress} ${NsaveStress} c_p c_press[*] c_pressVirial[*] c_pressVirialMod[*] c_stress[*] c_stressVirial[*] c_stressVirialMod[*] file ${Dir}/${file2_name}
fix fixStress5 all ave/time 1 1000 ${NsaveStress} c_p c_press[*] c_pressVirial[*] c_pressVirialMod[*] c_stress[*] c_stressVirial[*] c_stressVirialMod[*] file ${Dir}/${file2_name}
fix fixStress5 all ave/time 1 1000 1000 c_p c_press[*] c_pressVirial[*] c_pressVirialMod[*] c_stress[*] c_stressVirial[*] c_stressVirialMod[*] file ${Dir}/${file2_name}
fix fixStress5 all ave/time 1 1000 1000 c_p c_press[*] c_pressVirial[*] c_pressVirialMod[*] c_stress[*] c_stressVirial[*] c_stressVirialMod[*] file /home/franvt/GitRepos/molDynLammps/polymericGels/tests-3body/data/0.05331-2026-01-27-165515/${file2_name}
fix fixStress5 all ave/time 1 1000 1000 c_p c_press[*] c_pressVirial[*] c_pressVirialMod[*] c_stress[*] c_stressVirial[*] c_stressVirialMod[*] file /home/franvt/GitRepos/molDynLammps/polymericGels/tests-3body/data/0.05331-2026-01-27-165515/stress_assembly.fixf

# RUN SIMULATION

# Brownian Dynamics using Langevin Thermostat

timestep ${tstep}
timestep 0.001

fix VelVerlet all nve # Use Velocity Verlet integrator

# First elevate the temperature
fix ThermoLng all langevin 0.0 ${temp} ${damp} ${seed3} tally yes zero yes # Brownian Dynamics: langevin + nve
fix ThermoLng all langevin 0.0 0.05 ${damp} ${seed3} tally yes zero yes 
fix ThermoLng all langevin 0.0 0.05 1 ${seed3} tally yes zero yes 
fix ThermoLng all langevin 0.0 0.05 1 2010 tally yes zero yes 
run ${stepsheat}
run 30000
Hybrid pair style last /omp style table/omp
Last active /omp style is pair_style table/omp
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.4
  ghost atom cutoff = 2.4
  binsize = 1.2, bins = 2 2 2
  4 neighbor lists, perpetual/occasional/extra = 4 0 0
  (1) pair zero, perpetual, skip from (4)
      attributes: half, newton on, omp
      pair build: skip/omp
      stencil: none
      bin: none
  (2) pair table/omp, perpetual, skip from (4)
      attributes: half, newton on, omp
      pair build: skip/omp
      stencil: none
      bin: none
  (3) pair threebody/table, perpetual
      attributes: full, newton on, omp, cut 2.4
      pair build: full/bin/atomonly/omp
      stencil: full/bin/3d
      bin: standard
  (4) neighbor class addition, perpetual, half/full from (3)
      attributes: half, newton on, omp
      pair build: halffull/newton/omp
      stencil: none
      bin: none
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:1204)
Per MPI rank memory allocation (min/avg/max) = 7.25 | 7.5 | 8.25 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -0.011747417    0             -0.011747417   -0.16335085   
      1000   0.2245533     -0.76054442     0             -0.47985279    -0.40446932   
      2000   0.04266289    -0.74184321     0             -0.6885146     -0.034099839  
      3000   0.049310292   -0.82685056     0             -0.76521269    -0.13058275   
      4000   0.010566923   -0.82343807     0             -0.81022942    -0.0006898611 
      5000   0.004864629   -0.82687801     0             -0.82079723     0.089088724  
      6000   0.0089211698  -0.82708802     0             -0.81593656    -0.048677453  
      7000   0.15051564    -1.1526055      0             -0.96446099     0.21773801   
      8000   0.17885634    -0.92773368     0             -0.70416325     1.097576     
      9000   0.48806373     0.20096896     0              0.81104862    -0.5233313    
     10000   0.59254179    -0.43286135     0              0.30781589     0.33733639   
     11000   0.067866793    0.43560297     0              0.52043646    -0.097041287  
     12000   0.040244555    0.21873662     0              0.26904231    -0.22441107   
     13000   0.037576998   -0.50576436     0             -0.45879311    -0.14153681   
     14000   0.037566437    0.49354993     0              0.54050797    -0.51691766   
     15000   0.072930615    0.44270021     0              0.53386348    -1.3444621    
     16000   0.03507465    -0.83738818     0             -0.79354487    -0.48816101   
     17000   0.032250206   -0.82884409     0             -0.78853134     0.20834737   
     18000   0.30561584    -0.2359325      0              0.14608729    -1.3322583    
     19000   0.48374249     2.3378689      0              2.942547       0.17481462   
     20000   2.2108599      3.9264645      0              6.6900394     -10.322964    
     21000   1.9542643      3.6498353      0              6.0926657     -5.3671794    
     22000   1.7213699      4.2548391      0              6.4065514     -4.2388775    
     23000   0.59005963     5.0806663      0              5.8182408     -2.1241058    
     24000   0.45087706     5.1630278      0              5.7266241     -0.025461773  
     25000   0.33047204     5.1076497      0              5.5207397     -0.63952464   
     26000   0.74169919     5.2945761      0              6.2217001      0.0257164    
     27000   0.4028284      5.2203906      0              5.7239261     -0.15169838   
     28000   0.30233835     5.2744681      0              5.652391       0.53341983   
     29000   0.22987149     5.1643029      0              5.4516423     -0.3130564    
     30000   0.2086856      5.2000101      0              5.4608671      0.2463922    
Loop time of 2.41047 on 8 procs for 30000 steps with 6 atoms

Performance: 1075310.856 tau/day, 12445.728 timesteps/s, 74.674 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.10194    | 0.11438    | 0.13562    |   3.2 |  4.75
Neigh   | 0.00018257 | 0.00024195 | 0.00028693 |   0.0 |  0.01
Comm    | 0.32531    | 0.36763    | 0.38987    |   3.1 | 15.25
Output  | 0.00052514 | 0.00062805 | 0.00064624 |   0.0 |  0.03
Modify  | 1.8682     | 1.8804     | 1.9005     |   0.8 | 78.01
Other   |            | 0.04723    |            |       |  1.96

Nlocal:           0.75 ave           3 max           0 min
Histogram: 5 0 0 1 0 0 1 0 0 1
Nghost:            135 ave         161 max         111 min
Histogram: 2 2 0 0 0 0 0 0 2 2
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:           31 ave         124 max           0 min
Histogram: 5 0 0 1 0 0 1 0 0 1

Total # of neighbors = 248
Ave neighs/atom = 41.333333
Neighbor list builds = 24
Dangerous builds = 0

unfix ThermoLng

# Now we let the system to create the polymeric network
fix ThermoLng all langevin ${temp} ${temp} ${damp} ${seed3} tally yes zero yes # Brownian Dynamics: langevin + nve
fix ThermoLng all langevin 0.05 ${temp} ${damp} ${seed3} tally yes zero yes 
fix ThermoLng all langevin 0.05 0.05 ${damp} ${seed3} tally yes zero yes 
fix ThermoLng all langevin 0.05 0.05 1 ${seed3} tally yes zero yes 
fix ThermoLng all langevin 0.05 0.05 1 2010 tally yes zero yes 
run ${steps}
run 50000
Hybrid pair style last /omp style table/omp
Last active /omp style is pair_style table/omp
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:1204)
Per MPI rank memory allocation (min/avg/max) = 10.5 | 10.5 | 10.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
     30000   0.2086856      5.2000101      0              5.4608671      0.2463922    
     31000   0.10827234     5.1912912      0              5.3266316      0.62239821   
     32000   0.42991203     5.2408686      0              5.7782586     -0.71038564   
     33000   0.6432401      5.0566722      0              5.8607223     -0.916457     
     34000   0.56226305     5.1473565      0              5.8501853     -2.01701      
     35000   0.48999877     5.2243668      0              5.8368652      0.92274366   
     36000   0.36686922     5.2781177      0              5.7367042      0.7131286    
     37000   0.22618092     5.1831455      0              5.4658716      0.5743128    
     38000   0.6404827      5.2589205      0              6.0595238      0.8431058    
     39000   0.76063059     5.1143513      0              6.0651395      0.94558474   
     40000   0.44160517     4.6092666      0              5.161273      -4.7466491    
     41000   1.7594093      4.6663899      0              6.8656516      1.2838248    
     42000   0.33415486     5.0049068      0              5.4226004     -9.5143042    
     43000   0.57633831     5.1703186      0              5.8907415      0.81753166   
     44000   0.61752195     5.200293       0              5.9721955     -0.57779725   
     45000   0.99685518     4.9854525      0              6.2315215     -1.8918306    
     46000   0.44849686     4.9778243      0              5.5384454     -2.8545848    
     47000   0.96900445     4.8791637      0              6.0904193      0.59625689   
     48000   0.39751982     5.1395395      0              5.6364392     -0.089699872  
     49000   0.75022282     5.1048354      0              6.0426139      1.2332174    
     50000   0.71148784     4.987044       0              5.8764038      1.4360713    
     51000   1.0809385      5.2845265      0              6.6356996      1.6640546    
     52000   0.8622961      5.2517722      0              6.3296424     -2.4717649    
     53000   0.1339359      5.2169142      0              5.3843341     -0.2097475    
     54000   0.39239364     5.1590959      0              5.649588       0.85320732   
     55000   0.2662859      5.1752407      0              5.5080981     -0.15565509   
     56000   0.65657535     5.25306        0              6.0737792      0.66181404   
     57000   0.28583327     5.1269704      0              5.484262      -0.1323478    
     58000   0.27868845     5.1559976      0              5.5043582     -3.2272991    
     59000   0.66096128     5.1248574      0              5.951059      -6.3568903    
     60000   0.35256509     5.144396       0              5.5851023      0.04629872   
     61000   0.23753509     5.0761126      0              5.3730315     -6.7779594    
     62000   0.21576909     5.2554917      0              5.5252031     -3.0980662    
     63000   0.46652744     5.2182857      0              5.801445       0.67273281   
     64000   0.4599757      5.0713006      0              5.6462703      0.20817133   
     65000   0.53624652     5.0339603      0              5.7042684     -5.0533073    
     66000   0.85732598     5.1858134      0              6.2574708      0.59266257   
     67000   1.3391835      5.0705194      0              6.7444987     -2.7980368    
     68000   0.76393965     5.1965092      0              6.1514338      0.85967824   
     69000   0.83130821     5.0815146      0              6.1206498     -0.034204985  
     70000   0.732159       5.075975       0              5.9911737      0.72463262   
     71000   1.2417549      4.9169413      0              6.4691349     -5.5729184    
     72000   0.68563056     5.1178635      0              5.9749017     -0.25016428   
     73000   0.66916444     5.2266477      0              6.0631033     -0.29128513   
     74000   0.54362106     5.1445925      0              5.8241189     -0.21835328   
     75000   0.84834422     5.263362       0              6.3237923      0.87304435   
     76000   1.7535451      5.076037       0              7.2679684     -0.52825073   
     77000   0.38494967     4.9783586      0              5.4595457     -1.1318681    
     78000   0.454924       5.0879802      0              5.6566352      0.43586576   
     79000   0.28077104     5.2362211      0              5.5871849      0.46656375   
     80000   0.13323287     5.1883896      0              5.3549307     -0.22945939   
Loop time of 4.19997 on 8 procs for 50000 steps with 6 atoms

Performance: 1028579.300 tau/day, 11904.853 timesteps/s, 71.429 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.20476    | 0.21482    | 0.22894    |   1.5 |  5.11
Neigh   | 0.00059903 | 0.00063141 | 0.00066659 |   0.0 |  0.02
Comm    | 0.59986    | 0.6174     | 0.64608    |   2.1 | 14.70
Output  | 0.00089175 | 0.0010628  | 0.0010931  |   0.2 |  0.03
Modify  | 3.2483     | 3.2802     | 3.3055     |   1.2 | 78.10
Other   |            | 0.08582    |            |       |  2.04

Nlocal:           0.75 ave           3 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 2
Nghost:         156.75 ave         162 max         153 min
Histogram: 4 0 0 0 0 0 2 0 0 2
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:         30.5 ave         122 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 2

Total # of neighbors = 244
Ave neighs/atom = 40.666667
Neighbor list builds = 71
Dangerous builds = 0

# Write data for deformation

write_restart ${Dir}/${file6_name}
write_restart /home/franvt/GitRepos/molDynLammps/polymericGels/tests-3body/data/0.05331-2026-01-27-165515/${file6_name}
write_restart /home/franvt/GitRepos/molDynLammps/polymericGels/tests-3body/data/0.05331-2026-01-27-165515/data.hydrogel
System init for write_restart ...
Hybrid pair style last /omp style table/omp
Last active /omp style is pair_style table/omp
WARNING: Proc sub-domain size < neighbor skin, could lead to lost atoms (src/domain.cpp:1204)
Total wall time: 0:00:24
